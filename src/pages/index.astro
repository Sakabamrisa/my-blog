---
import { getCollection } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import Card from "@/components/Card.astro";
import getSortedPosts from "@/utils/getSortedPosts";
import IconArrowRight from "@/assets/icons/IconArrowRight.svg";
import LinkButton from "@/components/LinkButton.astro";

const posts = await getCollection("blog");
const sortedPosts = getSortedPosts(posts);
const recentPosts = sortedPosts.filter(({ data }) => !data.featured).slice(0, 3);
---

<Layout title="ä¸»é¡µ | å¼ éª">
  <!-- å½©è›‹ç”»å¸ƒå±‚ (é»˜è®¤å®Œå…¨é€æ˜ä¸”é¼ æ ‡ç©¿é€) -->
  <canvas 
    id="konami-canvas" 
    class="fixed inset-0 pointer-events-none z-[9999] opacity-0 transition-opacity duration-1000"
  ></canvas>

  <Header />
  
  <style>
    /* ========== æ ¸å¿ƒå¸ƒå±€è¿‡æ¸¡ ========== */
    .grid-accordion {
      display: grid;
      grid-template-rows: 0fr;
      transition: grid-template-rows 0.8s cubic-bezier(0.25, 1, 0.5, 1);
    }
    .grid-accordion.is-open {
      grid-template-rows: 1fr;
    }
    .grid-accordion-inner {
      overflow: hidden;
    }

    /* ========== ç§‘æŠ€æ„ŸèŠ‚ç‚¹è¿çº¿åŠ¨ç”»ç³»ç»Ÿ ========== */
    .magic-circle {
      opacity: 0;
      transform: translateY(20px) scale(0.5);
      transition: opacity 0.3s ease, transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .grid-accordion.is-open .magic-circle {
      opacity: 1;
      transform: translateY(0) scale(1);
      transition-delay: 0.1s;
    }

    .magic-line {
      transform-origin: left center;
      transform: scaleX(0);
      opacity: 0;
      transition: transform 0.6s cubic-bezier(0.85, 0, 0.15, 1), opacity 0.2s ease;
    }
    .grid-accordion.is-open .magic-line {
      transform: scaleX(1);
      opacity: 1;
      transition-delay: 0.4s;
    }

    .magic-item {
      opacity: 0;
      transform: translateX(-15px);
      transition: opacity 0.4s ease, transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    }
    .grid-accordion.is-open .magic-item {
      opacity: 1;
      transform: translateX(0);
    }
    
    .grid-accordion.is-open .delay-1 { transition-delay: 0.6s; }
    .grid-accordion.is-open .delay-2 { transition-delay: 0.7s; }
    .grid-accordion.is-open .delay-3 { transition-delay: 0.8s; }
    .grid-accordion.is-open .delay-4 { transition-delay: 0.9s; }
    .grid-accordion.is-open .delay-5 { transition-delay: 1.0s; }
    .grid-accordion.is-open .delay-6 { transition-delay: 1.1s; }

    /* ========== äº¤äº’çŠ¶æ€ ========== */
    .arrow-icon {
      transition: transform 0.5s cubic-bezier(0.25, 1, 0.5, 1), color 0.3s;
    }
    /* å‘å…‰æ¸¸æ ‡ */
    .glow-bar {
      transition: all 0.3s ease;
    }
    .group-hover-trigger:hover .glow-bar {
      box-shadow: 0 0 15px rgba(var(--color-accent-rgb), 0.6);
      width: 0.375rem; /* w-1.5 */
    }
  </style>

  <main id="main-content" class="app-layout py-12 min-h-[70vh]">
    
    <!-- ================= é¡¶çº§åŒºå— 1ï¼šå¼ éª ================= -->
    <div class="max-w-3xl mx-auto mb-16 relative">
      
      <!-- æ— è¾¹æ¡†è§¦å‘å™¨ -->
      <button 
        class="accordion-trigger w-full py-4 flex items-center justify-between text-left focus:outline-none group group-hover-trigger"
        data-target="level-1-content"
      >
        <div class="flex items-center gap-5">
          <div class="glow-bar w-1 h-10 bg-accent rounded-full"></div>
          <h1 class="text-4xl font-bold tracking-wide transition-transform duration-300 group-hover:translate-x-2">å¼ éª</h1>
        </div>
        <svg class="arrow-icon w-8 h-8 text-skin-base opacity-40 group-hover:text-accent group-hover:opacity-100" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </button>

      <!-- å†…å®¹åŒº -->
      <div id="level-1-content" class="grid-accordion">
        <div class="grid-accordion-inner">
          
          <!-- ç§‘å¹»èŠ‚ç‚¹ä¸è¿çº¿ UI -->
          <div class="pl-2 pt-2 pb-6 flex items-center">
            <div class="magic-circle relative flex items-center justify-center">
              <div class="w-3 h-3 rounded-full border-2 border-accent bg-skin-base z-10"></div>
              <div class="absolute w-6 h-6 bg-accent/20 rounded-full animate-ping"></div>
            </div>
            <div class="magic-line flex-1 h-[1px] ml-4 bg-gradient-to-r from-accent/50 to-transparent"></div>
          </div>

          <div class="pl-8 pb-8 space-y-6">
            
            <!-- ä¸ªäººç®€ä»‹ -->
            <div class="mb-10 pl-5 border-l-2 border-accent/30 magic-item delay-1">
              <p class="text-lg opacity-80 mb-2 text-accent font-medium tracking-wide">è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ Â· å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦ï¼ˆå¨æµ·ï¼‰</p>
              <p class="text-base leading-relaxed opacity-70">
                ä¸€ä¸ªçƒ­è¡·äºåšç‚¹æœ‰æ„æ€çš„äº‹æƒ…çš„æ™®é€šå¤§å­¦ç”Ÿï¼Œå¦‚æœä½ ä¹Ÿæƒ³åšç‚¹æœ‰è¶£çš„äº‹æƒ…ï¼Œä¸å¦¨å’Œæˆ‘èŠèŠï¼Ÿ
              </p>
            </div>

            <div class="space-y-2">
              
              <!-- æ¨¡å— 1ï¼šæ•™è‚²ç»å† -->
              <div class="magic-item delay-2">
                <button class="accordion-trigger w-full py-3 flex items-center justify-between text-left group/sub focus:outline-none" data-target="edu-content">
                  <h2 class="text-lg font-semibold flex items-center gap-4 transition-transform duration-300 group-hover/sub:translate-x-2 group-hover/sub:text-accent">
                    <span class="text-accent text-xl opacity-80 group-hover/sub:scale-110 transition-transform">ğŸ“</span> æ•™è‚²ç»å†
                  </h2>
                  <svg class="arrow-icon w-5 h-5 opacity-30 group-hover/sub:opacity-100" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </button>
                <div id="edu-content" class="grid-accordion">
                  <div class="grid-accordion-inner">
                    <div class="pl-12 py-3">
                      <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                        <div class="flex flex-wrap items-baseline gap-3 mb-1">
                          <span class="font-medium text-[1.05rem]">å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦ï¼ˆå¨æµ·ï¼‰</span>
                          <span class="text-xs font-mono opacity-50 px-2 py-0.5 rounded border border-border/50">2023 - 2027</span>
                        </div>
                        <p class="opacity-60 text-sm mt-1 tracking-wide">è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- æ¨¡å— 2ï¼šå‘è¡¨ç»å† -->
              <div class="magic-item delay-3">
                <button class="accordion-trigger w-full py-3 flex items-center justify-between text-left group/sub focus:outline-none" data-target="pub-content">
                  <h2 class="text-lg font-semibold flex items-center gap-4 transition-transform duration-300 group-hover/sub:translate-x-2 group-hover/sub:text-accent">
                    <span class="text-accent text-xl opacity-80 group-hover/sub:scale-110 transition-transform">ğŸ“„</span> å‘è¡¨ç»å†
                  </h2>
                  <svg class="arrow-icon w-5 h-5 opacity-30 group-hover/sub:opacity-100" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </button>
                <div id="pub-content" class="grid-accordion">
                  <div class="grid-accordion-inner">
                    <div class="pl-12 py-3">
                      <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                        <div class="font-medium text-[1.05rem] mb-2 leading-tight">ScEdit: Script-based Assessment of Knowledge Editing</div>
                        <div class="space-y-1.5 text-sm opacity-70">
                          <p class="flex items-center gap-2">
                            <span class="w-1 h-1 bg-accent rounded-full opacity-50"></span>
                            <span><strong class="font-medium opacity-100">Accepted by:</strong> ACL 2025 Findings</span>
                          </p>
                          <p class="flex items-start gap-2">
                            <span class="w-1 h-1 bg-accent rounded-full mt-2 opacity-50"></span>
                            <span><strong class="font-medium opacity-100">Authors:</strong> Xinye Li, Zunwen Zheng, Qian Zhang</span>
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- æ¨¡å— 3ï¼šç ”ç©¶ç»å† -->
              <div class="magic-item delay-4">
                <button class="accordion-trigger w-full py-3 flex items-center justify-between text-left group/sub focus:outline-none" data-target="work-content">
                  <h2 class="text-lg font-semibold flex items-center gap-4 transition-transform duration-300 group-hover/sub:translate-x-2 group-hover/sub:text-accent">
                    <span class="text-accent text-xl opacity-80 group-hover/sub:scale-110 transition-transform">ğŸ”¬</span> ç ”ç©¶ç»å†
                  </h2>
                  <svg class="arrow-icon w-5 h-5 opacity-30 group-hover/sub:opacity-100" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </button>
                <div id="work-content" class="grid-accordion">
                  <div class="grid-accordion-inner">
                    <div class="pl-12 py-3 space-y-6">
                      <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                        <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                          <span class="font-medium text-[1.05rem]">ä¸Šæµ·äº¤é€šå¤§å­¦ MVIG å®éªŒå®¤</span>
                          <span class="text-xs font-mono opacity-50">2024 - PRESENT</span>
                        </div>
                        <p class="text-accent text-sm opacity-80">ç§‘ç ”å®ä¹ ç”Ÿ</p>
                      </div>
                      <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                        <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                          <span class="font-medium text-[1.05rem]">å“ˆå·¥å¤§ ICES ç ”ç©¶ä¸­å¿ƒ</span>
                          <span class="text-xs font-mono opacity-50">2024 - PRESENT</span>
                        </div>
                        <p class="text-accent text-sm opacity-80">ç§‘ç ”å®ä¹ ç”Ÿ</p>
                      </div>
                      <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                        <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                          <span class="font-medium text-[1.05rem]">å“ˆå·¥å¤§å¨æµ·è”åˆåˆ›æ–°å¹³å°</span>
                          <span class="text-xs font-mono opacity-50">2023 - 2024</span>
                        </div>
                        <p class="text-accent text-sm opacity-80">ç¡¬ä»¶æŠ€æœ¯è´Ÿè´£äºº</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- æ¨¡å— 4ï¼šè£èª‰å¥–é¡¹ -->
              <div class="magic-item delay-5">
                <button class="accordion-trigger w-full py-3 flex items-center justify-between text-left group/sub focus:outline-none" data-target="award-content">
                  <h2 class="text-lg font-semibold flex items-center gap-4 transition-transform duration-300 group-hover/sub:translate-x-2 group-hover/sub:text-accent">
                    <span class="text-accent text-xl opacity-80 group-hover/sub:scale-110 transition-transform">ğŸ†</span> è£èª‰å¥–é¡¹
                  </h2>
                  <svg class="arrow-icon w-5 h-5 opacity-30 group-hover/sub:opacity-100" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </button>
                <div id="award-content" class="grid-accordion">
                  <div class="grid-accordion-inner">
                    <div class="pl-12 py-4 space-y-8">
                      <!-- å›½å®¶çº§ -->
                      <div>
                        <h3 class="text-xs font-bold text-accent mb-4 tracking-widest opacity-70 uppercase">å›½å®¶çº§</h3>
                        <div class="space-y-5">
                          <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                            <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                              <span class="font-medium">æŒ‘æˆ˜æ¯ä¸“é¡¹èµ›"æ­æ¦œæŒ‚å¸…"æ“‚å°èµ›</span>
                              <span class="text-xs opacity-50 font-mono">2025.10</span>
                            </div>
                            <p class="opacity-60 text-sm">å›½å®¶çº§äºŒç­‰å¥– Â· é˜Ÿé•¿ Â· äººå·¥æ™ºèƒ½é¢†åŸŸ</p>
                          </div>
                          <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                            <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                              <span class="font-medium">ç¬¬åå››å±Šå…¨å›½æµ·æ´‹èˆªè¡Œå™¨è®¾è®¡ä¸åˆ¶ä½œå¤§èµ›</span>
                              <span class="text-xs opacity-50 font-mono">2025.08</span>
                            </div>
                            <p class="opacity-60 text-sm">å›½å®¶çº§äºŒç­‰å¥– Â· ç¡¬ä»¶æŠ€æœ¯æš¨æ‹“æ‰‘æ¶æ„è´Ÿè´£äºº</p>
                          </div>
                          <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                            <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                              <span class="font-medium">å›½å®¶å¥–å­¦é‡‘</span>
                              <span class="text-xs opacity-50 font-mono">2024.12</span>
                            </div>
                            <p class="opacity-60 text-sm">è·å¾—10000ï¿¥ï¼</p>
                          </div>
                        </div>
                      </div>

                      <!-- çœçº§ -->
                      <div>
                        <h3 class="text-xs font-bold text-accent mb-4 tracking-widest opacity-70 uppercase">çœçº§</h3>
                        <div class="space-y-5">
                          <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                            <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                              <span class="font-medium">å…¨å›½å¤§å­¦ç”Ÿæ•°å­¦å»ºæ¨¡ç«èµ›</span>
                              <span class="text-xs opacity-50 font-mono">2024.11</span>
                            </div>
                            <p class="opacity-60 text-sm">å±±ä¸œèµ›åŒºä¸€ç­‰å¥–</p>
                          </div>
                          <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                            <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                              <span class="font-medium">ç¬¬åå››å±Šå…¨å›½æµ·æ´‹èˆªè¡Œå™¨è®¾è®¡ä¸åˆ¶ä½œå¤§èµ›</span>
                              <span class="text-xs opacity-50 font-mono">2025.08</span>
                            </div>
                            <p class="opacity-60 text-sm">é½é²èµ›åŒºäºŒç­‰å¥– Â· ç¡¬ä»¶æŠ€æœ¯æš¨æ‹“æ‰‘æ¶æ„è´Ÿè´£äºº</p>
                          </div>
                          <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                            <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                              <span class="font-medium">ç¬¬åä¹å±Šå…¨å›½å¤§å­¦ç”Ÿæ™ºèƒ½æ±½è½¦ç«èµ›</span>
                              <span class="text-xs opacity-50 font-mono">2024</span>
                            </div>
                            <p class="opacity-60 text-sm">å±±ä¸œèµ›åŒºæ‘©æ‰˜ç»„ä¸‰ç­‰å¥–</p>
                          </div>
                        </div>
                      </div>

                      <!-- æ ¡çº§è£èª‰ -->
                      <div>
                        <h3 class="text-xs font-bold text-accent mb-4 tracking-widest opacity-70 uppercase">æ ¡çº§è£èª‰ & å…¶ä»–</h3>
                        <div class="space-y-5">
                          <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                            <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                              <span class="font-medium">æœºç”²å¤§å¸ˆ (RoboMaster) æ ¡å†…èµ›</span>
                              <span class="text-xs opacity-50 font-mono">2023-2024</span>
                            </div>
                            <p class="opacity-60 text-sm">2024å¹´ç‰¹ç­‰å¥– Â· 2023å¹´ä¸€ç­‰å¥–</p>
                          </div>
                          <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                            <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                              <span class="font-medium">ç»¼åˆå­¦ä¸šç±»å¥–é¡¹</span>
                              <span class="text-xs opacity-50 font-mono">2024</span>
                            </div>
                            <p class="opacity-60 text-sm">ä¸€ç­‰å¥–å­¦é‡‘ã€äºŒç­‰äººæ°‘å¥–å­¦é‡‘ã€â€œå®å­¦å®å¹²â€ä¼˜ç§€å­¦ç”Ÿ</p>
                          </div>
                          <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                            <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                              <span class="font-medium">ç§‘æŠ€ç«èµ›ç±»æ ¡çº§å¥–é¡¹</span>
                              <span class="text-xs opacity-50 font-mono">2024-2025</span>
                            </div>
                            <p class="opacity-60 text-sm">â€œä»²è£æ¯â€AIæŒ‘æˆ˜èµ›é“œç‰Œã€æ™ºèƒ½è½¦å¨æµ·é‚€è¯·èµ›/æ ¡å†…èµ›ä¸‰ç­‰å¥–</p>
                          </div>
                          <div class="pl-4 border-l-2 border-border relative before:absolute before:w-1.5 before:h-1.5 before:bg-accent before:rounded-full before:-left-[4px] before:top-2.5">
                            <div class="flex flex-wrap justify-between items-baseline gap-2 mb-1">
                              <span class="font-medium">ç¤¾ä¼šå·¥ä½œ</span>
                              <span class="text-xs opacity-50 font-mono">2024.09</span>
                            </div>
                            <p class="opacity-60 text-sm">è˜ä»»ä¸ºå“ˆå·¥å¤§(å¨æµ·)â€œä¸€ç«™å¼â€å­¦ç”Ÿç¤¾åŒºæœ‹è¾ˆå¯¼å¸ˆ</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- æ¨¡å— 5ï¼šè”ç³»æ–¹å¼ -->
              <div class="magic-item delay-6">
                <button class="accordion-trigger w-full py-3 flex items-center justify-between text-left group/sub focus:outline-none" data-target="contact-content">
                  <h2 class="text-lg font-semibold flex items-center gap-4 transition-transform duration-300 group-hover/sub:translate-x-2 group-hover/sub:text-accent">
                    <span class="text-accent text-xl opacity-80 group-hover/sub:scale-110 transition-transform">âœ‰ï¸</span> è”ç³»æ–¹å¼
                  </h2>
                  <svg class="arrow-icon w-5 h-5 opacity-30 group-hover/sub:opacity-100" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </button>
                <div id="contact-content" class="grid-accordion">
                  <div class="grid-accordion-inner">
                    <div class="pl-12 py-3">
                      <div class="flex flex-col gap-3">
                        <a href="mailto:zhangqian.work@outlook.com" class="flex items-center gap-4 w-fit group/link">
                          <div class="text-skin-base opacity-40 group-hover/link:text-accent group-hover/link:opacity-100 transition-all">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg>
                          </div>
                          <span class="font-mono text-sm opacity-70 group-hover/link:text-accent group-hover/link:opacity-100 transition-colors">zhangqian.work@outlook.com</span>
                        </a>
                        <a href="https://github.com/Sakabamrisa" target="_blank" class="flex items-center gap-4 w-fit group/link">
                          <div class="text-skin-base opacity-40 group-hover/link:text-accent group-hover/link:opacity-100 transition-all">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg>
                          </div>
                          <span class="font-mono text-sm opacity-70 group-hover/link:text-accent group-hover/link:opacity-100 transition-colors">github.com/Sakabamrisa</span>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ================= é¡¶çº§åŒºå— 2ï¼šæœ€æ–°åŠ¨æ€ ================= -->
    {
      recentPosts.length > 0 && (
        <div class="max-w-3xl mx-auto relative group">
          
          <button 
            class="accordion-trigger w-full py-4 flex items-center justify-between text-left focus:outline-none group group-hover-trigger"
            data-target="recent-posts-content"
          >
            <div class="flex items-center gap-5">
              <div class="glow-bar w-1 h-8 bg-accent rounded-full"></div>
              <h2 class="text-3xl font-bold tracking-wide transition-transform duration-300 group-hover:translate-x-2">æœ€æ–°åŠ¨æ€</h2>
            </div>
            <svg class="arrow-icon w-8 h-8 text-skin-base opacity-40 group-hover:text-accent group-hover:opacity-100" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>

          <div id="recent-posts-content" class="grid-accordion">
            <div class="grid-accordion-inner">
              
              <div class="pl-2 pt-2 pb-6 flex items-center">
                <div class="magic-circle relative flex items-center justify-center">
                  <div class="w-3 h-3 rounded-full border-2 border-accent bg-skin-base z-10"></div>
                  <div class="absolute w-6 h-6 bg-accent/20 rounded-full animate-ping" style="animation-duration: 2s;"></div>
                </div>
                <div class="magic-line flex-1 h-[1px] ml-4 bg-gradient-to-r from-accent/50 to-transparent"></div>
              </div>

              <div class="pl-8 pb-8 space-y-4">
                <div class="opacity-80">
                  {recentPosts.map((data, index) => (
                    <div class={`magic-item delay-${index + 1}`}>
                      <Card variant="h3" {...data} />
                    </div>
                  ))}
                </div>
                
                <div class="pt-6 flex justify-start magic-item delay-4">
                  <LinkButton href="/posts/" class="group/btn flex items-center gap-2 text-sm font-medium opacity-60 hover:opacity-100 hover:text-accent transition-all duration-300">
                    <span class="border-b border-transparent group-hover/btn:border-accent pb-0.5">æ¢ç´¢å…¨éƒ¨æ–‡ç« </span>
                    <IconArrowRight class="inline-block rtl:-rotate-180 transition-transform group-hover/btn:translate-x-1" />
                  </LinkButton>
                </div>
              </div>

            </div>
          </div>
        </div>
      )
    }
  </main>
  <Footer />
</Layout>

<script>
  // ========== åŸå§‹äº¤äº’ä»£ç  ==========
  function initAccordions() {
    const triggers = document.querySelectorAll('.accordion-trigger');
    
    triggers.forEach(trigger => {
      trigger.removeEventListener('click', toggleAccordion);
      trigger.addEventListener('click', toggleAccordion);
    });

    function toggleAccordion(this: HTMLElement) {
      const targetId = this.getAttribute('data-target');
      if (!targetId) return;
      
      const content = document.getElementById(targetId);
      const icon = this.querySelector('.arrow-icon');
      const text = this.querySelector('h1') || this.querySelector('h2'); 
      
      if (content) {
        const isOpen = content.classList.contains('is-open');
        content.classList.toggle('is-open');
        
        if (icon) {
          if (!isOpen) {
            icon.classList.add('-rotate-180', 'text-accent');
            icon.classList.remove('opacity-30', 'opacity-40');
            if(text && text.tagName === 'H2') text.classList.add('text-accent');
          } else {
            icon.classList.remove('-rotate-180', 'text-accent');
            icon.classList.add('opacity-40'); 
            if(text && text.tagName === 'H2') text.classList.remove('text-accent');
          }
        }
      }
    }
  }

  document.addEventListener('DOMContentLoaded', initAccordions);
  document.addEventListener('astro:page-load', initAccordions);

  document.addEventListener("astro:page-load", () => {
    const indexLayout = (document.querySelector("#main-content") as HTMLElement)?.dataset?.layout;
    if (indexLayout) {
      sessionStorage.setItem("backUrl", "/");
    }
  });


  // ========== éšè—å½©è›‹ç³»ç»Ÿ (Konami Code) ==========
  // è§¦å‘åºåˆ—ï¼šä¸Šã€ä¸Šã€ä¸‹ã€ä¸‹ã€å·¦ã€å·¦ã€å³ã€å³ã€Bã€Aã€Bã€A
  const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowLeft', 'ArrowRight', 'ArrowRight', 'b', 'a', 'b', 'a'];
  let konamiIndex = 0;

  function initEasterEggListener() {
    document.addEventListener('keydown', (e) => {
      // è·å–æŒ‰é”®å¹¶ç»Ÿä¸€è½¬ä¸ºå°å†™å¯¹æ¯”ï¼Œå…¼å®¹å¤§å°å†™
      const key = e.key.toLowerCase();
      const targetKey = konamiCode[konamiIndex].toLowerCase();
      
      if (key === targetKey) {
        konamiIndex++;
        if (konamiIndex === konamiCode.length) {
          triggerPixelWave();
          konamiIndex = 0; // é‡ç½®è¿›åº¦
        }
      } else {
        konamiIndex = 0;
        // å¦‚æœæŒ‰é”™çš„é”®åˆšå¥½æ˜¯ç¬¬ä¸€ä¸ªé”®ï¼Œåˆ™é‡ç½®ä¸ºç¬¬ä¸€æ­¥
        if (key === konamiCode[0].toLowerCase()) {
          konamiIndex = 1;
        }
      }
    });
  }

  // æ¸²æŸ“åƒç´ æ³¢æµªç‰¹æ•ˆ
  function triggerPixelWave() {
    const canvas = document.getElementById('konami-canvas') as HTMLCanvasElement;
    if (!canvas || canvas.dataset.playing === 'true') return;
    
    const ctx = canvas.getContext('2d');
    if (!ctx) return;

    console.log("%cğŸ‰ å½©è›‹è§¦å‘ï¼šä¸ƒå½©åƒç´ æ³¢æµªé˜µï¼", "color: #ff00ff; font-size: 20px; font-weight: bold;");

    canvas.dataset.playing = 'true';
    canvas.style.opacity = '1';
    
    let width = window.innerWidth;
    let height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;
    
    let time = 0;
    let animationId: number;
    const size = 32; // åƒç´ å—åŸºç¡€å¤§å°

    function resizeCanvas() {
      width = window.innerWidth;
      height = window.innerHeight;
      canvas.width = width;
      canvas.height = height;
    }
    window.addEventListener('resize', resizeCanvas);

    function draw() {
      // æ¯æ¬¡ç»˜åˆ¶å‰æ¸…ç©ºç”»å¸ƒ
      ctx!.clearRect(0, 0, width, height);
      
      const cols = Math.ceil(width / size);
      const rows = Math.ceil(height / size);
      
      for (let x = 0; x < cols; x++) {
        for (let y = 0; y < rows; y++) {
          // åˆ©ç”¨å¤šé‡æ­£å¼¦æ³¢äº§ç”Ÿæµä½“åƒç´ æ³¢æµªæ„Ÿ
          const v1 = Math.sin(x * 0.15 + time * 0.04);
          const v2 = Math.sin(y * 0.15 + time * 0.04);
          const v3 = Math.sin((x + y) * 0.1 + time * 0.06);
          const v = v1 + v2 + v3; // æ³¢åŠ¨å€¼ï¼ŒèŒƒå›´çº¦ -3 åˆ° 3
          
          // è®¡ç®—åŠ¨æ€ä¸ƒå½©è‰²ç›¸
          const hue = (v * 50 + time * 2) % 360;
          
          // è®¡ç®—åƒç´ å—çš„å¤§å°ç¼©æ”¾ï¼ˆäº§ç”Ÿå‘¼å¸è·³è·ƒæ„Ÿï¼‰
          const pulse = (Math.sin(v + time * 0.1) + 1) / 2; // 0 åˆ° 1
          const currentSize = size * (0.3 + pulse * 0.7); // å¤§å°åœ¨ 30% - 100% ä¹‹é—´æ³¢åŠ¨
          const offset = (size - currentSize) / 2; // å±…ä¸­åç§»é‡
          
          // åŠé€æ˜å¡«å……ï¼Œä¸é®æŒ¡åº•å±‚æ–‡å­—
          ctx!.fillStyle = `hsla(${hue}, 100%, 65%, 0.5)`;
          ctx!.fillRect(x * size + offset, y * size + offset, currentSize, currentSize);
        }
      }
      
      time++;
      animationId = requestAnimationFrame(draw);
    }
    
    draw();
    
    // 8ç§’åè‡ªåŠ¨æ·¡å‡ºå¹¶åœæ­¢æ¸²æŸ“ï¼Œé¿å…å ç”¨æ€§èƒ½
    setTimeout(() => {
      canvas.style.opacity = '0';
      setTimeout(() => {
        cancelAnimationFrame(animationId);
        canvas.dataset.playing = 'false';
        ctx.clearRect(0, 0, width, height);
        window.removeEventListener('resize', resizeCanvas);
      }, 1000); // é…åˆ CSS é‡Œçš„ duration-1000 æ¸éšæ—¶é—´
    }, 8000);
  }

  // Astro é¡µé¢ç”Ÿå‘½å‘¨æœŸæŒ‚è½½
  document.addEventListener('astro:page-load', () => {
    // é¿å…é‡å¤ç»‘å®šç›‘å¬
    if (!(window as any)._konamiBinded) {
      initEasterEggListener();
      (window as any)._konamiBinded = true;
    }
  });
</script>